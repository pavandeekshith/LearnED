{"version":3,"file":"static/js/852.aa95fabf.chunk.js","mappings":"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","sources":["pages/TeacherOnboarding.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport { supabase } from '../lib/supabaseClient';\n\nconst TeacherOnboarding = () => {\n    const [formData, setFormData] = useState({\n        firstName: '',\n        lastName: '',\n        password: '',\n        confirmPassword: '',\n        phoneNumber: '',\n        profilePictureUrl: '',\n        bio: '',\n        qualifications: '',\n        experience_years: '',\n        specializations: '',\n        availability_timezone: '',\n    });\n    const [error, setError] = useState('');\n    const [loading, setLoading] = useState(false);\n    const [authLoading, setAuthLoading] = useState(true);\n    const [token, setToken] = useState(null);\n    const [email, setEmail] = useState('');\n    const [invitation, setInvitation] = useState(null);\n    const location = useLocation();\n    const navigate = useNavigate();\n\n    useEffect(() => {\n        console.log('üîç TeacherOnboarding mounted');\n        console.log('üìç Current URL:', window.location.href);\n        console.log('üîó Hash:', window.location.hash);\n        \n        const handleAuthChange = async (event, session) => {\n            console.log('üîê Auth event:', event);\n            console.log('üë§ Session:', session);\n            console.log('‚è∞ Auth loading state BEFORE:', authLoading);\n            \n            if (event === 'SIGNED_IN' && session?.user) {\n                const user = session.user;\n                console.log('‚úÖ User authenticated:', user);\n                console.log('üìß User email:', user.email);\n                console.log('üìù User metadata:', user.user_metadata);\n                \n                setEmail(user.email);\n                setFormData(prev => ({\n                    ...prev,\n                    firstName: user.user_metadata.first_name || '',\n                    lastName: user.user_metadata.last_name || ''\n                }));\n                \n                // Check for valid invitation\n                try {\n                    console.log('üîç Checking for invitation...');\n                    console.log('üìß Looking for email:', user.email);\n                    console.log('üìÖ Current time:', new Date().toISOString());\n                    \n                    // First, check all invitations for this email (debug)\n                    const { data: allInvites, error: allInvitesError } = await supabase\n                        .from('teacher_invitations')\n                        .select('*')\n                        .eq('email', user.email);\n                    \n                    if (allInvitesError) {\n                        console.error('‚ùå RLS ERROR - Cannot read teacher_invitations table:', allInvitesError);\n                        setError('Database access error. Please contact admin. Error: ' + allInvitesError.message);\n                        setAuthLoading(false);\n                        return;\n                    }\n                    \n                    console.log('üìã All invitations for this email:', allInvites);\n                    \n                    const { data: invitations, error: inviteError } = await supabase\n                        .from('teacher_invitations')\n                        .select('*')\n                        .eq('email', user.email)\n                        .eq('status', 'pending')\n                        .gt('expires_at', new Date().toISOString())\n                        .limit(1);\n                    \n                    console.log('üì® Valid invitation query result:', invitations);\n                    console.log('üì® Invitation query error (if any):', inviteError);\n                    \n                    if (inviteError) {\n                        console.error('‚ùå Invitation query error:', inviteError);\n                        setError('Error checking invitation: ' + inviteError.message);\n                        setAuthLoading(false);  // CRITICAL: Set loading to false even on error\n                    } else if (!invitations || invitations.length === 0) {\n                        console.warn('‚ö†Ô∏è No valid invitation found');\n                        setError('No valid invitation found for ' + user.email + '. Please check your email or contact admin.');\n                        setAuthLoading(false);  // CRITICAL: Set loading to false\n                    } else {\n                        console.log('‚úÖ Valid invitation found:', invitations[0]);\n                        setInvitation(invitations[0]);\n                        setFormData(prev => ({\n                            ...prev,\n                            firstName: invitations[0].first_name || user.user_metadata.first_name || '',\n                            lastName: invitations[0].last_name || user.user_metadata.last_name || ''\n                        }));\n                        setAuthLoading(false);  // CRITICAL: Set loading to false on success\n                    }\n                } catch (err) {\n                    console.error('üí• Unexpected error:', err);\n                    setError('Unexpected error: ' + err.message);\n                }\n                \n                setAuthLoading(false);\n            } else if (event === 'SIGNED_OUT') {\n                console.log('üö™ User signed out');\n                setAuthLoading(false);\n            }\n        };\n\n        const { data: authListener } = supabase.auth.onAuthStateChange(handleAuthChange);\n\n        // Handle the case where the user is already signed in when the component mounts\n        const checkSession = async () => {\n            console.log('üîç Checking existing session...');\n            const { data: { session }, error: sessionError } = await supabase.auth.getSession();\n            \n            if (sessionError) {\n                console.error('‚ùå Session error:', sessionError);\n                setError('Authentication error: ' + sessionError.message);\n                setAuthLoading(false);\n                return;\n            }\n            \n            if (session?.user) {\n                console.log('‚úÖ Existing session found');\n                await handleAuthChange('SIGNED_IN', session);\n            } else {\n                console.log('‚ö†Ô∏è No existing session');\n                setError('No authentication found. Please check your email and click the magic link again.');\n                setAuthLoading(false);\n            }\n        };\n        checkSession();\n\n        return () => {\n            if (authListener && authListener.subscription) {\n                authListener.subscription.unsubscribe();\n            }\n        };\n    }, [navigate]);\n\n    const handleChange = (e) => {\n        const { name, value } = e.target;\n        setFormData(prevState => ({\n            ...prevState,\n            [name]: value\n        }));\n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        setError('');\n\n        // Validation checks\n        if (!formData.password || formData.password.trim() === '') {\n            setError('Password is required.');\n            return;\n        }\n\n        if (formData.password.length < 8) {\n            setError('Password must be at least 8 characters long.');\n            return;\n        }\n\n        if (formData.password !== formData.confirmPassword) {\n            setError('Passwords do not match. Please re-enter.');\n            return;\n        }\n\n        if (formData.phoneNumber && formData.phoneNumber.trim() !== '') {\n            const digitsOnly = formData.phoneNumber.replace(/\\D/g, '');\n            if (digitsOnly.length < 7 || digitsOnly.length > 15) {\n                setError('Please enter a valid phone number (7-15 digits).');\n                return;\n            }\n        }\n\n        setLoading(true);\n\n        try {\n            console.log('üìù Starting teacher onboarding submission...');\n            \n            // 1. Update the user's password\n            console.log('üîê Updating password...');\n            const { error: passwordError } = await supabase.auth.updateUser({\n                password: formData.password\n            });\n\n            if (passwordError) {\n                console.error('‚ùå Password update error:', passwordError);\n                throw passwordError;\n            }\n            console.log('‚úÖ Password updated successfully');\n\n            // 2. Call the RPC to complete the onboarding process\n            console.log('üìû Calling complete_teacher_onboarding RPC...');\n            const { data: rpcData, error: rpcError } = await supabase.rpc('complete_teacher_onboarding', {\n                p_first_name: formData.firstName || null,\n                p_last_name: formData.lastName || null,\n                p_phone: formData.phoneNumber || null,\n                p_profile_image_url: formData.profilePictureUrl || null,\n                p_bio: formData.bio || null,\n                p_qualifications: formData.qualifications || null,\n                p_experience_years: formData.experience_years ? parseInt(formData.experience_years) : null,\n                p_specializations: formData.specializations \n                    ? formData.specializations.split(',').map(s => s.trim()).filter(Boolean) \n                    : null,\n                p_availability_timezone: formData.availability_timezone || null\n            });\n\n            if (rpcError) {\n                console.error('‚ùå RPC error:', rpcError);\n                throw rpcError;\n            }\n            \n            console.log('‚úÖ Onboarding completed successfully:', rpcData);\n\n            setLoading(false);\n            alert('Onboarding complete! You have been successfully registered as a teacher. You can now login using the mobile app.');\n            \n            // Sign out to clear the session\n            await supabase.auth.signOut();\n            navigate('/'); // Redirect to home page\n\n        } catch (error) {\n            console.error('üí• Onboarding error:', error);\n            setError(error.message || 'An unexpected error occurred.');\n            setLoading(false);\n        }\n    };\n\n    return (\n        <div className=\"min-h-screen bg-gray-100 flex flex-col justify-center items-center\">\n            <div className=\"bg-white shadow-md rounded-lg p-8 max-w-md w-full\">\n                <h2 className=\"text-2xl font-bold text-center text-gray-800 mb-6\">Complete Your Teacher Profile</h2>\n                \n                {authLoading && (\n                    <div className=\"text-center py-8\">\n                        <div className=\"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500\"></div>\n                        <p className=\"mt-4 text-gray-600\">Verifying your authentication...</p>\n                    </div>\n                )}\n                \n                {error && <p className=\"text-red-500 text-center mb-4\">{error}</p>}\n                \n                {!authLoading && !invitation && (\n                    <div className=\"text-center py-4\">\n                        <p className=\"text-gray-600\">Please check your email and click the magic link to continue.</p>\n                    </div>\n                )}\n\n                {!authLoading && invitation && <form onSubmit={handleSubmit}>\n                    <div className=\"mb-4\">\n                        <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"email\">\n                            Email\n                        </label>\n                        <input\n                            type=\"email\"\n                            name=\"email\"\n                            id=\"email\"\n                            value={email}\n                            disabled\n                            className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline bg-gray-200\"\n                        />\n                    </div>\n                    <div className=\"mb-4\">\n                        <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"firstName\">\n                            First Name\n                        </label>\n                        <input\n                            type=\"text\"\n                            name=\"firstName\"\n                            id=\"firstName\"\n                            value={formData.firstName}\n                            onChange={handleChange}\n                            className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n                            required\n                        />\n                    </div>\n                    <div className=\"mb-4\">\n                        <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"lastName\">\n                            Last Name\n                        </label>\n                        <input\n                            type=\"text\"\n                            name=\"lastName\"\n                            id=\"lastName\"\n                            value={formData.lastName}\n                            onChange={handleChange}\n                            className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n                            required\n                        />\n                    </div>\n                    <div className=\"mb-4\">\n                        <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"password\">\n                            Password (min 8 characters) <span className=\"text-red-500\">*</span>\n                        </label>\n                        <input\n                            type=\"password\"\n                            name=\"password\"\n                            id=\"password\"\n                            value={formData.password}\n                            onChange={handleChange}\n                            className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n                            required\n                        />\n                    </div>\n                    <div className=\"mb-6\">\n                        <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"confirmPassword\">\n                            Confirm Password <span className=\"text-red-500\">*</span>\n                        </label>\n                        <input\n                            type=\"password\"\n                            name=\"confirmPassword\"\n                            id=\"confirmPassword\"\n                            value={formData.confirmPassword}\n                            onChange={handleChange}\n                            className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline\"\n                            required\n                        />\n                    </div>\n                     <div className=\"mb-4\">\n                        <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"phoneNumber\">\n                            Phone Number <span className=\"text-red-500\">*</span>\n                        </label>\n                        <input\n                            type=\"tel\"\n                            name=\"phoneNumber\"\n                            id=\"phoneNumber\"\n                            value={formData.phoneNumber}\n                            onChange={handleChange}\n                            placeholder=\"Enter your phone number\"\n                            className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n                            required\n                        />\n                    </div>\n                     <div className=\"mb-4\">\n                        <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"profilePictureUrl\">\n                            Profile Picture URL\n                        </label>\n                        <input\n                            type=\"text\"\n                            name=\"profilePictureUrl\"\n                            id=\"profilePictureUrl\"\n                            value={formData.profilePictureUrl}\n                            onChange={handleChange}\n                            className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n                        />\n                    </div>\n                    <div className=\"mb-6\">\n                        <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"bio\">\n                            Bio / About Me\n                        </label>\n                        <textarea\n                            name=\"bio\"\n                            id=\"bio\"\n                            value={formData.bio}\n                            onChange={handleChange}\n                            className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n                            rows=\"4\"\n                        />\n                    </div>\n                    <div className=\"mb-4\">\n                        <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"qualifications\">\n                            Qualifications\n                        </label>\n                        <input\n                            type=\"text\"\n                            name=\"qualifications\"\n                            id=\"qualifications\"\n                            value={formData.qualifications}\n                            onChange={handleChange}\n                            className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n                        />\n                    </div>\n                    <div className=\"mb-4\">\n                        <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"experience_years\">\n                            Years of Experience\n                        </label>\n                        <input\n                            type=\"number\"\n                            name=\"experience_years\"\n                            id=\"experience_years\"\n                            value={formData.experience_years}\n                            onChange={handleChange}\n                            className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n                        />\n                    </div>\n                    <div className=\"mb-4\">\n                        <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"specializations\">\n                            Specializations (comma-separated)\n                        </label>\n                        <input\n                            type=\"text\"\n                            name=\"specializations\"\n                            id=\"specializations\"\n                            value={formData.specializations}\n                            onChange={handleChange}\n                            className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n                        />\n                    </div>\n                    <div className=\"mb-6\">\n                        <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"availability_timezone\">\n                            Timezone\n                        </label>\n                        <input\n                            type=\"text\"\n                            name=\"availability_timezone\"\n                            id=\"availability_timezone\"\n                            value={formData.availability_timezone}\n                            onChange={handleChange}\n                            className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n                        />\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                        <button\n                            type=\"submit\"\n                            disabled={loading}\n                            className=\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline w-full disabled:bg-gray-400\"\n                        >\n                            {loading ? 'Submitting...' : 'Complete Registration'}\n                        </button>\n                    </div>\n                </form>}\n            </div>\n        </div>\n    );\n};\n\nexport default TeacherOnboarding;\n"],"names":["TeacherOnboarding","formData","setFormData","useState","firstName","lastName","password","confirmPassword","phoneNumber","profilePictureUrl","bio","qualifications","experience_years","specializations","availability_timezone","error","setError","loading","setLoading","authLoading","setAuthLoading","token","setToken","email","setEmail","invitation","setInvitation","navigate","useLocation","useNavigate","useEffect","console","log","window","location","href","hash","handleAuthChange","async","event","session","user","user_metadata","prev","_objectSpread","first_name","last_name","Date","toISOString","data","allInvites","allInvitesError","supabase","from","select","eq","message","invitations","inviteError","gt","limit","length","warn","err","authListener","auth","onAuthStateChange","sessionError","getSession","checkSession","subscription","unsubscribe","handleChange","e","name","value","target","prevState","_jsx","className","children","_jsxs","onSubmit","preventDefault","trim","digitsOnly","replace","passwordError","updateUser","rpcData","rpcError","rpc","p_first_name","p_last_name","p_phone","p_profile_image_url","p_bio","p_qualifications","p_experience_years","parseInt","p_specializations","split","map","s","filter","Boolean","p_availability_timezone","alert","signOut","htmlFor","type","id","disabled","onChange","required","placeholder","rows"],"sourceRoot":""}