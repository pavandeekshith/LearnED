"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[412],{3412:(e,s,r)=>{r.r(s),r.d(s,{default:()=>x});var a=r(5043),l=r(5016),n=r(6767),d=r(2555),t=r(6415),o=r(759),i=r(579);const c=e=>{let{boardFilter:s,gradeFilter:r}=e;const{adminData:l}=(0,t.z8)(),[n,c]=(0,a.useState)(null),[x,m]=(0,a.useState)({}),[p,h]=(0,a.useState)([]),[u,b]=(0,a.useState)([]),[y,j]=(0,a.useState)(""),[v,g]=(0,a.useState)(""),N=l.classrooms||[];(0,a.useEffect)((()=>{void 0!==s&&j(s),void 0!==r&&g(r)}),[s,r]),(0,a.useEffect)((()=>{N.length>0&&(h([...new Set(N.map((e=>e.board)).filter(Boolean))]),b([...new Set(N.map((e=>e.grade_level)).filter(Boolean))]))}),[N]);const _=N.filter((e=>(!y||e.board===y)&&(!v||String(e.grade_level)===String(v)))),f=(e,s)=>{if(console.log("Getting price for classroom:",e.id,"plan:",s),console.log("Classroom pricing:",e.classroom_pricing),!e.classroom_pricing)return"-";const r=e.classroom_pricing.find((e=>{var r,a;return e.payment_plan_id===s||(null===(r=e.payment_plans)||void 0===r?void 0:r.billing_cycle)===s||(null===(a=e.payment_plans)||void 0===a?void 0:a.id)===s}));return console.log("Found pricing:",r),(null===r||void 0===r?void 0:r.price)||"-"},C=(e,s)=>{if(!e.classroom_pricing)return null;const r=e.classroom_pricing.find((e=>{var r,a;return e.payment_plan_id===s||(null===(r=e.payment_plans)||void 0===r?void 0:r.billing_cycle)===s||(null===(a=e.payment_plans)||void 0===a?void 0:a.id)===s}));return null===r||void 0===r?void 0:r.id},w=e=>{m((0,d.A)((0,d.A)({},x),{},{[e.target.name]:e.target.value}))},S=async()=>{await o.N.from("classrooms").update({name:x.name,board:x.board,grade_level:x.grade_level,subject:x.subject}).eq("id",n);const e=["monthly","quarterly","yearly"];for(const s of e){const e=x["".concat(s,"_price")],r=C(N.find((e=>e.id===n)),s);e&&"-"!==e?r?await o.N.from("classroom_pricing").update({price:e}).eq("id",r):await o.N.from("classroom_pricing").insert({classroom_id:n,payment_plan_id:s,price:e}):r&&await o.N.from("classroom_pricing").delete().eq("id",r)}c(null),fetchClassrooms()};return(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{className:"font-semibold mb-2",children:"Existing Classrooms"}),0===N.length?(0,i.jsx)("div",{className:"text-center py-4 text-gray-500",children:"No classrooms found"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,i.jsxs)("select",{value:y,onChange:e=>j(e.target.value),className:"border px-2 py-1 rounded",children:[(0,i.jsx)("option",{value:"",children:"All Boards"}),p.map((e=>(0,i.jsx)("option",{value:e,children:e},e)))]}),(0,i.jsxs)("select",{value:v,onChange:e=>g(e.target.value),className:"border px-2 py-1 rounded",children:[(0,i.jsx)("option",{value:"",children:"All Grades"}),u.map((e=>(0,i.jsx)("option",{value:e,children:e},e)))]})]}),(0,i.jsxs)("table",{className:"min-w-full border text-sm",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"border px-2 py-1",children:"Name"}),(0,i.jsx)("th",{className:"border px-2 py-1",children:"Board"}),(0,i.jsx)("th",{className:"border px-2 py-1",children:"Grade"}),(0,i.jsx)("th",{className:"border px-2 py-1",children:"Subject"}),(0,i.jsx)("th",{className:"border px-2 py-1",children:"Teacher"}),(0,i.jsx)("th",{className:"border px-2 py-1",children:"Monthly Price"}),(0,i.jsx)("th",{className:"border px-2 py-1",children:"Quarterly Price"}),(0,i.jsx)("th",{className:"border px-2 py-1",children:"Yearly Price"}),(0,i.jsx)("th",{className:"border px-2 py-1",children:"Actions"})]})}),(0,i.jsx)("tbody",{children:_.map((e=>{var s,r,a,l;return(0,i.jsx)("tr",{children:n===e.id?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("td",{className:"border px-2 py-1",children:(0,i.jsx)("input",{name:"name",value:x.name,onChange:w,className:"border rounded px-1"})}),(0,i.jsx)("td",{className:"border px-2 py-1",children:(0,i.jsx)("input",{name:"board",value:x.board,onChange:w,className:"border rounded px-1"})}),(0,i.jsx)("td",{className:"border px-2 py-1",children:(0,i.jsx)("input",{name:"grade_level",value:x.grade_level,onChange:w,className:"border rounded px-1"})}),(0,i.jsx)("td",{className:"border px-2 py-1",children:(0,i.jsx)("input",{name:"subject",value:x.subject,onChange:w,className:"border rounded px-1"})}),(0,i.jsx)("td",{className:"border px-2 py-1",children:(0,i.jsx)("span",{className:"text-gray-600",children:x.teacher_name})}),(0,i.jsx)("td",{className:"border px-2 py-1",children:(0,i.jsx)("input",{name:"monthly_price",value:x.monthly_price,onChange:w,className:"border rounded px-1"})}),(0,i.jsx)("td",{className:"border px-2 py-1",children:(0,i.jsx)("input",{name:"quarterly_price",value:x.quarterly_price,onChange:w,className:"border rounded px-1"})}),(0,i.jsx)("td",{className:"border px-2 py-1",children:(0,i.jsx)("input",{name:"yearly_price",value:x.yearly_price,onChange:w,className:"border rounded px-1"})}),(0,i.jsxs)("td",{className:"border px-2 py-1",children:[(0,i.jsx)("button",{onClick:S,className:"bg-green-500 text-white px-2 py-1 rounded mr-1",children:"Save"}),(0,i.jsx)("button",{onClick:()=>c(null),className:"bg-gray-400 text-white px-2 py-1 rounded",children:"Cancel"})]})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("td",{className:"border px-2 py-1",children:e.name}),(0,i.jsx)("td",{className:"border px-2 py-1",children:e.board}),(0,i.jsx)("td",{className:"border px-2 py-1",children:e.grade_level}),(0,i.jsx)("td",{className:"border px-2 py-1",children:e.subject}),(0,i.jsx)("td",{className:"border px-2 py-1",children:(null===(s=e.teachers)||void 0===s||null===(r=s.users)||void 0===r?void 0:r.first_name)+" "+(null===(a=e.teachers)||void 0===a||null===(l=a.users)||void 0===l?void 0:l.last_name)||"No Teacher"}),(0,i.jsx)("td",{className:"border px-2 py-1",children:f(e,"monthly")}),(0,i.jsx)("td",{className:"border px-2 py-1",children:f(e,"quarterly")}),(0,i.jsx)("td",{className:"border px-2 py-1",children:f(e,"yearly")}),(0,i.jsx)("td",{className:"border px-2 py-1",children:(0,i.jsx)("button",{onClick:()=>(e=>{var s,r,a,l;c(e.id),m((0,d.A)((0,d.A)({},e),{},{monthly_price:f(e,"monthly"),quarterly_price:f(e,"quarterly"),yearly_price:f(e,"yearly"),teacher_name:(null===(s=e.teachers)||void 0===s||null===(r=s.users)||void 0===r?void 0:r.first_name)+" "+(null===(a=e.teachers)||void 0===a||null===(l=a.users)||void 0===l?void 0:l.last_name)||""}))})(e),className:"bg-yellow-500 text-white px-2 py-1 rounded",children:"Edit"})})]})},e.id)}))})]})]})]})},x=()=>{const{user:e,logout:s}=(0,l.A)(),r=(0,n.Zp)(),[d,t]=(0,a.useState)(""),[o,x]=(0,a.useState)("");return(0,i.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,i.jsx)("header",{className:"bg-white shadow",children:(0,i.jsxs)("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Classroom Management"}),(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsxs)("span",{className:"text-gray-700",children:["Welcome, ",null===e||void 0===e?void 0:e.email]}),(0,i.jsx)("button",{onClick:async()=>{await s(),r("/")},className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-md",children:"Logout"})]})]}),(0,i.jsx)("nav",{className:"mt-6",children:(0,i.jsxs)("div",{className:"flex space-x-8",children:[(0,i.jsx)("button",{onClick:()=>r("/admin/dashboard"),className:"text-gray-500 hover:text-gray-700 px-3 py-2 font-medium text-sm",children:"Dashboard"}),(0,i.jsx)("button",{onClick:()=>r("/admin/classrooms"),className:"border-b-2 border-blue-500 text-blue-600 px-3 py-2 font-medium text-sm",children:"Classrooms"}),(0,i.jsx)("button",{onClick:()=>r("/admin/teachers"),className:"text-gray-500 hover:text-gray-700 px-3 py-2 font-medium text-sm",children:"Teachers"}),(0,i.jsx)("button",{onClick:()=>r("/admin/students"),className:"text-gray-500 hover:text-gray-700 px-3 py-2 font-medium text-sm",children:"Students"})]})})]})}),(0,i.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,i.jsx)("div",{className:"px-4 py-6 sm:px-0",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Manage Classrooms"}),(0,i.jsxs)("div",{className:"flex gap-4 mb-4",children:[(0,i.jsx)("button",{className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-md",children:"Add New Classroom"}),(0,i.jsx)("button",{className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-md",children:"Delete Selected"})]}),(0,i.jsxs)("div",{className:"flex gap-4 mb-4",children:[(0,i.jsxs)("select",{value:d,onChange:e=>t(e.target.value),className:"border border-gray-300 rounded-md px-3 py-2",children:[(0,i.jsx)("option",{value:"",children:"All Boards"}),(0,i.jsx)("option",{value:"CBSE",children:"CBSE"}),(0,i.jsx)("option",{value:"ICSE",children:"ICSE"}),(0,i.jsx)("option",{value:"IGCSE",children:"IGCSE"})]}),(0,i.jsxs)("select",{value:o,onChange:e=>x(e.target.value),className:"border border-gray-300 rounded-md px-3 py-2",children:[(0,i.jsx)("option",{value:"",children:"All Grades"}),(0,i.jsx)("option",{value:"6",children:"Grade 6"}),(0,i.jsx)("option",{value:"7",children:"Grade 7"}),(0,i.jsx)("option",{value:"8",children:"Grade 8"}),(0,i.jsx)("option",{value:"9",children:"Grade 9"}),(0,i.jsx)("option",{value:"10",children:"Grade 10"})]})]})]}),(0,i.jsx)(c,{boardFilter:d,gradeFilter:o})]})})})]})}}}]);
//# sourceMappingURL=412.9787c1a7.chunk.js.map